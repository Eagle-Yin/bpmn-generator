<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BPMN流程图渲染器</title>
    <link rel="stylesheet" href="https://unpkg.com/bpmn-js@9.4.0/dist/assets/diagram-js.css">
    <link rel="stylesheet" href="https://unpkg.com/bpmn-js@9.4.0/dist/assets/bpmn-js.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'PingFang SC', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background-color: #f7f9fc;
            color: #333;
            line-height: 1.6;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #3498db, #2c3e50);
            color: white;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .header h1 {
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 1.1rem;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .main-content {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .input-panel {
            flex: 1;
            min-width: 300px;
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }
        
        .input-panel h2 {
            margin-bottom: 15px;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        
        .input-area {
            margin-bottom: 20px;
        }
        
        textarea {
            width: 100%;
            min-height: 200px;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-family: monospace;
            resize: vertical;
            font-size: 14px;
        }
        
        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .btn {
            padding: 10px 18px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .btn:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }
        
        .btn-success {
            background-color: #2ecc71;
        }
        
        .btn-success:hover {
            background-color: #27ae60;
        }
        
        .btn-warning {
            background-color: #f39c12;
        }
        
        .btn-warning:hover {
            background-color: #e67e22;
        }
        
        .canvas-container {
            flex: 2;
            min-width: 500px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            display: flex;
            flex-direction: column;
        }
        
        .canvas-header {
            padding: 15px 20px;
            background: #2c3e50;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .canvas-header h2 {
            font-size: 1.4rem;
        }
        
        .zoom-controls {
            display: flex;
            gap: 8px;
        }
        
        .zoom-btn {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
        }
        
        .zoom-btn:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }
        
        #canvas {
            flex: 1;
            min-height: 500px;
            width: 100%;
        }
        
        .status-bar {
            padding: 12px 20px;
            background: #f8f9fa;
            border-top: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
            color: #6c757d;
        }
        
        .loading {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.9);
            justify-content: center;
            align-items: center;
            flex-direction: column;
            z-index: 100;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(52, 152, 219, 0.3);
            border-radius: 50%;
            border-top-color: #3498db;
            animation: spin 1s ease-in-out infinite;
            margin-bottom: 15px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .error-container {
            display: none;
            padding: 20px;
            text-align: center;
            background: #ffecec;
            border-radius: 8px;
            border-left: 4px solid #e74c3c;
            margin-top: 20px;
        }
        
        .error-icon {
            font-size: 2.5rem;
            color: #e74c3c;
            margin-bottom: 15px;
        }
        
        .info-panel {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }
        
        .info-panel h3 {
            margin-bottom: 15px;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        
        .legend {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .color-box {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            margin-right: 10px;
        }
        
        .start-event { background-color: #2ecc71; }
        .task { background-color: #3498db; }
        .gateway { background-color: #f39c12; }
        .end-event { background-color: #e74c3c; }
        
        .footer {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        @media (max-width: 900px) {
            .main-content {
                flex-direction: column;
            }
            
            .input-panel, .canvas-container {
                min-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>BPMN 流程图渲染器</h1>
            <p>专业、精准的BPMN 2.0流程图可视化工具</p>
        </div>
        
        <div class="main-content">
            <div class="input-panel">
                <h2>BPMN XML 输入</h2>
                <div class="input-area">
                    <textarea id="bpmn-xml-input" placeholder="请在此处粘贴BPMN 2.0 XML代码..."><bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" id="Definitions_1" targetNamespace="http://bpmn.io/schema/bpmn">
  <bpmn:process id="Process_1" isExecutable="false">
    <bpmn:startEvent id="StartEvent_1"/>
  </bpmn:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_1">
      <bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1">
        <dc:Bounds x="173" y="102" width="36" height="36"/>
      </bpmndi:BPMNShape>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions></textarea>
                </div>
                
                <div class="controls">
                    <button id="render-btn" class="btn">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"></path>
                        </svg>
                        渲染流程图
                    </button>
                    <button id="clear-btn" class="btn btn-warning">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M18 6L6 18M6 6l12 12"></path>
                        </svg>
                        清除
                    </button>
                    <button id="example-btn" class="btn btn-success">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 5v14M5 12h14"></path>
                        </svg>
                        加载示例
                    </button>
                </div>
                
                <div class="error-container" id="error-container">
                    <div class="error-icon">⚠️</div>
                    <h3>渲染错误</h3>
                    <p id="error-message"></p>
                </div>
            </div>
            
            <div class="canvas-container">
                <div class="canvas-header">
                    <h2>流程图预览</h2>
                    <div class="zoom-controls">
                        <button class="zoom-btn" id="zoom-in" title="放大">+</button>
                        <button class="zoom-btn" id="zoom-out" title="缩小">-</button>
                        <button class="zoom-btn" id="zoom-fit" title="适应窗口">⤢</button>
                    </div>
                </div>
                
                <div id="canvas"></div>
                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <p>正在渲染流程图...</p>
                </div>
                
                <div class="status-bar">
                    <span id="status-info">等待输入</span>
                    <span id="element-count">元素: 0</span>
                </div>
            </div>
        </div>
        
        <div class="info-panel">
            <h3>BPMN 图例说明</h3>
            <div class="legend">
                <div>
                    <div class="legend-item">
                        <div class="color-box start-event"></div>
                        <div>开始事件</div>
                    </div>
                    <div class="legend-item">
                        <div class="color-box task"></div>
                        <div>任务/活动</div>
                    </div>
                    <div class="legend-item">
                        <div class="color-box gateway"></div>
                        <div>网关/决策点</div>
                    </div>
                    <div class="legend-item">
                        <div class="color-box end-event"></div>
                        <div>结束事件</div>
                    </div>
                </div>
                <div>
                    <p>BPMN（业务流程模型与标注）是一种用于描述业务流程的标准。此渲染器基于bpmn-js库构建，支持BPMN 2.0标准的流程图渲染。</p>
                </div>
                <div>
                    <p>只需将BPMN 2.0 XML代码粘贴到左侧输入框，点击"渲染流程图"即可可视化您的业务流程。</p>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>Powered by bpmn-js | 专注于BPMN 2.0标准流程图的可视化渲染</p>
        </div>
    </div>

    <!-- 引入 bpmn-js 库 -->
    <script src="https://unpkg.com/bpmn-js@9.4.0/dist/bpmn-viewer.development.js"></script>

    <script>
        // 全局变量
        let bpmnViewer = null;
        
        // DOM 元素
        const xmlInput = document.getElementById('bpmn-xml-input');
        const renderBtn = document.getElementById('render-btn');
        const clearBtn = document.getElementById('clear-btn');
        const exampleBtn = document.getElementById('example-btn');
        const canvas = document.getElementById('canvas');
        const loadingElement = document.getElementById('loading');
        const errorContainer = document.getElementById('error-container');
        const errorMessageElem = document.getElementById('error-message');
        const statusInfo = document.getElementById('status-info');
        const elementCount = document.getElementById('element-count');
        const zoomInBtn = document.getElementById('zoom-in');
        const zoomOutBtn = document.getElementById('zoom-out');
        const zoomFitBtn = document.getElementById('zoom-fit');
        
        // 示例BPMN XML
        const exampleBPMN = `
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" id="Definitions_1" targetNamespace="http://bpmn.io/schema/bpmn">
  <bpmn:process id="Process_1" isExecutable="false">
    <bpmn:startEvent id="StartEvent_1">
      <bpmn:outgoing>SequenceFlow_1</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:userTask id="UserTask_1">
      <bpmn:incoming>SequenceFlow_1</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_2</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:exclusiveGateway id="ExclusiveGateway_1">
      <bpmn:incoming>SequenceFlow_2</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_3</bpmn:outgoing>
      <bpmn:outgoing>SequenceFlow_4</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:serviceTask id="ServiceTask_1">
      <bpmn:incoming>SequenceFlow_3</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_5</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:endEvent id="EndEvent_1">
      <bpmn:incoming>SequenceFlow_4</bpmn:incoming>
      <bpmn:incoming>SequenceFlow_5</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:sequenceFlow id="SequenceFlow_1" sourceRef="StartEvent_1" targetRef="UserTask_1" />
    <bpmn:sequenceFlow id="SequenceFlow_2" sourceRef="UserTask_1" targetRef="ExclusiveGateway_1" />
    <bpmn:sequenceFlow id="SequenceFlow_3" sourceRef="ExclusiveGateway_1" targetRef
<span style='font-size:12px'>[AI生成]</span>
